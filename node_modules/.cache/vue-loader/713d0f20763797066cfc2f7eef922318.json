{"remainingRequest":"/home/kali/fronted_manager/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/kali/fronted_manager/src/views/DataPanel.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/kali/fronted_manager/src/views/DataPanel.vue","mtime":1725806466821},{"path":"/home/kali/fronted_manager/node_modules/cache-loader/dist/cjs.js","mtime":1725805665522},{"path":"/home/kali/fronted_manager/node_modules/babel-loader/lib/index.js","mtime":1725805665488},{"path":"/home/kali/fronted_manager/node_modules/cache-loader/dist/cjs.js","mtime":1725805665522},{"path":"/home/kali/fronted_manager/node_modules/vue-loader/lib/index.js","mtime":1725805708031}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICAgIG5hbWU6ICJEYXRhUGFuZWwiLAoKICAgIGRhdGE6ICgpID0+ICh7CiAgICAgICAgdGltZXI6IG51bGwsCiAgICAgICAgdGlja1RpbWVyOiBudWxsLAogICAgICAgIGxvYWRpbmdMb2c6IGZhbHNlLAoKICAgICAgICB0aW1lOiBudWxsLAogICAgICAgIG1pbnV0ZTogMCwKICAgICAgICBzZWNvbmQ6IDAsCgogICAgICAgIGxvZ3M6IFtdLAogICAgICAgIHJhbms6IFtdLAogICAgICAgIHJhbmtIZWFkZXI6IFtdLAogICAgICAgIHBhbmVsOiB7fSwKICAgIH0pLAoKICAgIG1vdW50ZWQoKSB7CiAgICAgICAgdGhpcy5sb29wKCkKCiAgICAgICAgdGhpcy50aW1lciA9IHNldEludGVydmFsKHRoaXMubG9vcCwgNTAwMCkKCiAgICAgICAgdGhpcy50aWNrVGltZXIgPSBzZXRJbnRlcnZhbCgoKSA9PiB7CiAgICAgICAgICAgIGlmICh0aGlzLnRpbWUgIT09IG51bGwpIHsKICAgICAgICAgICAgICAgIGlmICh0aGlzLnRpbWVbJ1JvdW5kUmVtYWluVGltZSddLS0gPD0gMCkgewogICAgICAgICAgICAgICAgICAgIHRoaXMudGltZS5Sb3VuZFJlbWFpblRpbWUgPSB0aGlzLnRpbWUuRHVyYXRpb24gKiA2MAogICAgICAgICAgICAgICAgICAgIHRoaXMudGltZS5Ob3dSb3VuZCsrCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB0aGlzLm1pbnV0ZSA9IE1hdGguZmxvb3IodGhpcy50aW1lLlJvdW5kUmVtYWluVGltZSAvIDYwKQogICAgICAgICAgICAgICAgdGhpcy5zZWNvbmQgPSB0aGlzLnRpbWUuUm91bmRSZW1haW5UaW1lIC0gdGhpcy5taW51dGUgKiA2MAogICAgICAgICAgICB9CiAgICAgICAgfSwgMTAwMCkKICAgIH0sCgogICAgYmVmb3JlRGVzdHJveSgpIHsKICAgICAgICBjbGVhckludGVydmFsKHRoaXMudGltZXIpCiAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLnRpY2tUaW1lcikKICAgIH0sCgogICAgbWV0aG9kczogewogICAgICAgIGxvb3AoKSB7CiAgICAgICAgICAgIHRoaXMuZ2V0VGltZSgpCiAgICAgICAgICAgIHRoaXMuZ2V0TG9ncygpCiAgICAgICAgICAgIHRoaXMuZ2V0UmFuaygpCiAgICAgICAgICAgIHRoaXMuZ2V0UGFuZWwoKQogICAgICAgIH0sCgogICAgICAgIGdldFRpbWUoKSB7CiAgICAgICAgICAgIHRoaXMudXRpbHMuR0VUKCcvdGltZScpLnRoZW4ocmVzID0+IHsKICAgICAgICAgICAgICAgIHRoaXMudGltZSA9IHJlcwogICAgICAgICAgICB9KS5jYXRjaChlcnIgPT4gdGhpcy4kbWVzc2FnZSh7bWVzc2FnZTogZXJyLCB0eXBlOiAnZXJyb3InfSkpCiAgICAgICAgfSwKCiAgICAgICAgZ2V0TG9ncygpIHsKICAgICAgICAgICAgdGhpcy5sb2FkaW5nTG9nID0gdHJ1ZQogICAgICAgICAgICB0aGlzLnV0aWxzLkdFVCgnL21hbmFnZXIvbG9ncycpLnRoZW4ocmVzID0+IHsKICAgICAgICAgICAgICAgIHRoaXMubG9ncyA9IHJlcwogICAgICAgICAgICAgICAgdGhpcy5sb2FkaW5nTG9nID0gZmFsc2UKICAgICAgICAgICAgfSkuY2F0Y2goZXJyID0+IHRoaXMuJG1lc3NhZ2Uoe21lc3NhZ2U6IGVyciwgdHlwZTogJ2Vycm9yJ30pKQogICAgICAgIH0sCgogICAgICAgIGdldFJhbmsoKSB7CiAgICAgICAgICAgIHRoaXMudXRpbHMuR0VUKCcvbWFuYWdlci9yYW5rJykudGhlbihyZXMgPT4gewogICAgICAgICAgICAgICAgdGhpcy5yYW5rID0gcmVzLlJhbmsKICAgICAgICAgICAgICAgIHRoaXMucmFua0hlYWRlciA9IHJlcy5UaXRsZQogICAgICAgICAgICB9KS5jYXRjaChlcnIgPT4gdGhpcy4kbWVzc2FnZSh7bWVzc2FnZTogZXJyLCB0eXBlOiAnZXJyb3InfSkpCiAgICAgICAgfSwKCiAgICAgICAgZ2V0UGFuZWwoKSB7CiAgICAgICAgICAgIHRoaXMudXRpbHMuR0VUKCcvbWFuYWdlci9wYW5lbCcpLnRoZW4ocmVzID0+IHsKICAgICAgICAgICAgICAgIHRoaXMucGFuZWwgPSByZXMKICAgICAgICAgICAgfSkuY2F0Y2goZXJyID0+IHRoaXMuJG1lc3NhZ2Uoe21lc3NhZ2U6IGVyciwgdHlwZTogJ2Vycm9yJ30pKQogICAgICAgIH0sCgogICAgICAgIC8vIGV4cG9ydFJhbmsoKSB7CiAgICAgICAgLy8gICAgIHRoaXMuZ2V0UmFuaygpCiAgICAgICAgLy8gbGV0IGNvbnRlbnQgPSAnJwogICAgICAgIC8vCiAgICAgICAgLy8gbGV0IGJsb2IgPSBuZXcgQmxvYihbSlNPTi5zdHJpbmdpZnkocmVzKV0sIHt0eXBlOiAndGV4dC9wbGFpbid9KQogICAgICAgIC8vIGxldCBkb3dubG9hZEVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJhIikKICAgICAgICAvLyBsZXQgaHJlZiA9IHdpbmRvdy5VUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpCiAgICAgICAgLy8gZG93bmxvYWRFbGVtZW50LmhyZWYgPSBocmVmCiAgICAgICAgLy8gZG93bmxvYWRFbGVtZW50LmRvd25sb2FkID0gbmFtZQogICAgICAgIC8vIGRvd25sb2FkRWxlbWVudC5jbGljaygpCiAgICAgICAgLy8gd2luZG93LlVSTC5yZXZva2VPYmplY3RVUkwoaHJlZikKICAgICAgICAvLyB9CgogICAgICAgIHN0YXR1c0NsYXNzKGF0dGFja2VkLCBkb3duKSB7CiAgICAgICAgICAgIGlmIChhdHRhY2tlZCAmJiBkb3duKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gJ3N0YXR1cy1kb3VibGUnCiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGF0dGFja2VkKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gJ3N0YXR1cy1hdHRhY2tlZCcKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoZG93bikgewogICAgICAgICAgICAgICAgcmV0dXJuICdzdGF0dXMtZG93bicKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gJ3N0YXR1cy1ub3JtYWwnCiAgICAgICAgfQogICAgfSwKCiAgICBjb21wdXRlZDogewogICAgICAgIHByb2dyZXNzUGVyY2VudCgpIHsKICAgICAgICAgICAgbGV0IHBlcmNlbnQgPSBOdW1iZXIoKCgobmV3IERhdGUoKS5nZXRUaW1lKCkgLyAxMDAwKSAtIHRoaXMudGltZS5CZWdpblRpbWUpIC8gKHRoaXMudGltZS5FbmRUaW1lIC0gdGhpcy50aW1lLkJlZ2luVGltZSkgKiAxMDApLnRvRml4ZWQoMikpCiAgICAgICAgICAgIGlmIChwZXJjZW50ID4gMTAwKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gMTAwCiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIHBlcmNlbnQKICAgICAgICB9CiAgICB9Cn0K"},{"version":3,"sources":["DataPanel.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwGA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"DataPanel.vue","sourceRoot":"src/views","sourcesContent":["<template>\n    <div>\n        <el-row :gutter=\"12\">\n            <el-col :span=\"14\">\n                <el-card shadow=\"always\" v-loading=\"loadingLog\">\n                    <div slot=\"header\" class=\"clearfix\">\n                        <span v-if=\"time !== null\">\n                            <span v-if=\"time.Status === 'wait'\">\n                                <b>{{$t('panel.not_begin')}}</b>\n                            </span>\n                            <span v-if=\"time.Status === 'on'\"\n                                  v-html=\"$t('panel.til_round_end', { round: time.NowRound, minute: minute, second: second})\">\n                            </span>\n                            <span v-if=\"time.Status === 'pause'\">\n                                <b>{{$t('panel.pause')}}</b>\n                            </span>\n                            <span v-if=\"time.Status === 'end'\">\n                                <b>{{$t('panel.end')}}</b>\n                            </span>\n                        </span>\n\n                        <!-- Debug info -->\n                        <el-popover\n                                style=\"float: right;\"\n                                placement=\"bottom\"\n                                title=\"\"\n                                width=\"300\"\n                                trigger=\"click\">\n                            <p>{{$t('panel.previous_round_zero_title')}}{{ panel.PreviousRoundScore}}\n                                <el-tag size=\"mini\" type=\"success\" v-if=\"panel.PreviousRoundScore <= 0\">\n                                    {{$t('panel.ok')}}\n                                </el-tag>\n                                <el-tag size=\"mini\" type=\"danger\" v-else>{{$t('panel.zero_alert')}}</el-tag>\n                            </p>\n                            <p>{{$t('panel.total_zero_title')}}{{ panel.TotalScore }}\n                                <el-tag size=\"mini\" type=\"success\" v-if=\"panel.TotalScore <= 0\">{{$t('panel.ok')}}\n                                </el-tag>\n                                <el-tag size=\"mini\" type=\"danger\" v-else>{{$t('panel.zero_alert')}}</el-tag>\n                            </p>\n                            <el-button slot=\"reference\" size=\"mini\">{{$t('panel.debug_info')}}</el-button>\n                        </el-popover>\n                        <el-progress v-if=\"time !== null\"\n                                     :text-inside=\"true\"\n                                     :stroke-width=\"17\"\n                                     :percentage=\"progressPercent\"></el-progress>\n                    </div>\n                    <div class=\"system-log\">\n                        <div v-for=\"(log, index) in logs\" v-bind:key=\"index\">\n                            <div class=\"system-log-body\">\n                                <span class=\"system-log-time\">[{{ utils.FormatGoTime(log.CreatedAt) }}]</span>\n                                <span :class=\"'system-log-'+['normal', 'warning', 'important'][log.Level]\">\n                                    [{{['NORMAL', 'WARNING', 'IMPORTANT'][log.Level]}}]\n                                </span>\n                                <span class=\"system-log-message\">{{ log.Content }}</span>\n                            </div>\n                        </div>\n                    </div>\n                </el-card>\n            </el-col>\n            <el-col :span=\"10\">\n                <el-card shadow=\"always\">\n                    <el-table :data=\"rank\" stripe style=\"width: 100%\" height=\"530\" max-height=\"530\" size=\"small\">\n                        <el-table-column type=\"index\" label=\"#\" width=\"50\"></el-table-column>\n                        <el-table-column prop=\"TeamName\" :label=\"$t('panel.team')\"></el-table-column>\n                        <el-table-column prop=\"Score\" :label=\"$t('panel.score')\"\n                                         :formatter=\"(row) => utils.FormatFloat(row.Score)\"></el-table-column>\n                        <el-table-column v-for=\"(header, index) in rankHeader\" v-bind:key=\"index\" :label=\"header\">\n                            <template scope=\"scope\">\n                                <span v-if=\"scope.row.GameBoxStatus[index].IsAttacked\" color=\"green lighten-2\">✔️</span>\n                                 <!-- <span :score=\"utils.FormatFloat(scope.row.GameBoxStatus[index].Score)\"\n                                       :class=\"statusClass(scope.row.GameBoxStatus[index].IsAttacked, scope.row.GameBoxStatus[index].IsDown)\">{{utils.FormatFloat(scope.row.GameBoxStatus[index].Score)}}</span> -->\n                            </template>\n                        </el-table-column>\n                    </el-table>\n                    <br>\n                    <!--                    <el-button size=\"mini\" @click=\"exportRank\">{{$t('panel.export_rank')}}</el-button>-->\n                </el-card>\n                <br>\n                <el-card>\n                    <el-row :gutter=\"20\">\n                        <el-col :span=\"6\" class=\"panel\">\n                            <p class=\"panel-data\">{{ panel.SubmitFlag }}</p>\n                            <span class=\"panel-text\">{{$t('panel.submit_flag_count')}}</span>\n                        </el-col>\n                        <el-col :span=\"6\" class=\"panel\">\n                            <p class=\"panel-data\">{{ panel.CheckDown }}</p>\n                            <span class=\"panel-text\">{{$t('panel.checkdown_count')}}</span>\n                        </el-col>\n                        <el-col :span=\"6\" class=\"panel\">\n                            <p class=\"panel-data\">{{ panel.MemAllocated }}</p>\n                            <span class=\"panel-text\">{{$t('panel.memory_allocated')}}</span>\n                        </el-col>\n                        <el-col :span=\"6\" class=\"panel\" style=\"border-right-width: 0;\">\n                            <p class=\"panel-data\">{{ panel.NumGoroutine }}</p>\n                            <span class=\"panel-text\">{{$t('panel.goroutine_count')}}</span>\n                        </el-col>\n                    </el-row>\n                </el-card>\n            </el-col>\n        </el-row>\n    </div>\n</template>\n\n<script>\n    export default {\n        name: \"DataPanel\",\n\n        data: () => ({\n            timer: null,\n            tickTimer: null,\n            loadingLog: false,\n\n            time: null,\n            minute: 0,\n            second: 0,\n\n            logs: [],\n            rank: [],\n            rankHeader: [],\n            panel: {},\n        }),\n\n        mounted() {\n            this.loop()\n\n            this.timer = setInterval(this.loop, 5000)\n\n            this.tickTimer = setInterval(() => {\n                if (this.time !== null) {\n                    if (this.time['RoundRemainTime']-- <= 0) {\n                        this.time.RoundRemainTime = this.time.Duration * 60\n                        this.time.NowRound++\n                    }\n                    this.minute = Math.floor(this.time.RoundRemainTime / 60)\n                    this.second = this.time.RoundRemainTime - this.minute * 60\n                }\n            }, 1000)\n        },\n\n        beforeDestroy() {\n            clearInterval(this.timer)\n            clearInterval(this.tickTimer)\n        },\n\n        methods: {\n            loop() {\n                this.getTime()\n                this.getLogs()\n                this.getRank()\n                this.getPanel()\n            },\n\n            getTime() {\n                this.utils.GET('/time').then(res => {\n                    this.time = res\n                }).catch(err => this.$message({message: err, type: 'error'}))\n            },\n\n            getLogs() {\n                this.loadingLog = true\n                this.utils.GET('/manager/logs').then(res => {\n                    this.logs = res\n                    this.loadingLog = false\n                }).catch(err => this.$message({message: err, type: 'error'}))\n            },\n\n            getRank() {\n                this.utils.GET('/manager/rank').then(res => {\n                    this.rank = res.Rank\n                    this.rankHeader = res.Title\n                }).catch(err => this.$message({message: err, type: 'error'}))\n            },\n\n            getPanel() {\n                this.utils.GET('/manager/panel').then(res => {\n                    this.panel = res\n                }).catch(err => this.$message({message: err, type: 'error'}))\n            },\n\n            // exportRank() {\n            //     this.getRank()\n            // let content = ''\n            //\n            // let blob = new Blob([JSON.stringify(res)], {type: 'text/plain'})\n            // let downloadElement = document.createElement(\"a\")\n            // let href = window.URL.createObjectURL(blob)\n            // downloadElement.href = href\n            // downloadElement.download = name\n            // downloadElement.click()\n            // window.URL.revokeObjectURL(href)\n            // }\n\n            statusClass(attacked, down) {\n                if (attacked && down) {\n                    return 'status-double'\n                }\n                if (attacked) {\n                    return 'status-attacked'\n                }\n                if (down) {\n                    return 'status-down'\n                }\n                return 'status-normal'\n            }\n        },\n\n        computed: {\n            progressPercent() {\n                let percent = Number((((new Date().getTime() / 1000) - this.time.BeginTime) / (this.time.EndTime - this.time.BeginTime) * 100).toFixed(2))\n                if (percent > 100) {\n                    return 100\n                }\n                return percent\n            }\n        }\n    }\n</script>\n\n<style scoped>\n    .system-log {\n        font-family: Consolas, \"Noto Sans CJK SC Regular\", \"Microsoft YaHei UI Light\",\n        monospace;\n    }\n\n    .system-log-time {\n        color: #aaa;\n    }\n\n    .system-log-normal {\n        color: #aaa;\n    }\n\n    .system-log-warning {\n        color: orange;\n    }\n\n    .system-log-important {\n        color: red;\n    }\n\n    .panel {\n        border: 0 solid #bbbbbb;\n        border-right-width: 1px;\n        text-align: center;\n    }\n\n    .panel-data {\n        text-align: center;\n        font-size: 30px;\n        color: #409EFF;\n    }\n\n    .panel-text {\n        text-align: center;\n        color: #3f3f3f;\n        font-size: 15px;\n    }\n\n    .status-normal {\n        color: green;\n    }\n\n    .status-down {\n        color: orange;\n    }\n\n    .status-attacked {\n        color: red;\n    }\n\n    .status-double {\n        color: red;\n        font-weight: 900;\n    }\n\n    .status-double::before {\n        position: absolute;\n        height: 30%;\n        content: attr(score);\n        overflow: hidden;\n        color: orange;\n        z-index: 999;\n    }\n</style>"]}]}